---
title: "Ischemic Stroke Among Adults With Versus Without Active Cancer: An Assessment of Person-Level Characteristics and Risk Profiles"
author: "Emily Acton"
output: 
  html_document:
    toc: false 
    depth: 3 
    theme: paper 
    highlight: tango
---
```{r set-options, echo=FALSE, cache=FALSE}
options(width = 400)
```  
***
Use this template to complete your project throughout the course. Your Final Project presentation will be based on the contents of this document. Replace the title/name above and text below with your own, but keep the headers.



### Overview
Give a brief a description of your project and its goal(s), what data you are using to complete it, and what three faculty/staff in different fields you have spoken to about your project with a brief summary of what you learned from each person. Include a link to your final project GitHub repository.

  Recent research has demonstrated a significantly increased risk of ischemic stroke among those with active cancer, yet the mechanisms underlying cancer-associated stroke and optimal prevention strategies remain incompletely understood.  An essential step towards advancing this understanding is the rigorous evaluation of the sociodemographic characteristics, comorbidities, and cardiometabolic profiles associated with ischemic stroke among those with cancer.  Thus, using the unique combination of interview and physical examination data collected as part of the National Health and Nutrition Examination Survey (NHANES), I aim to assess the person-level characteristics and risk factors associated with ischemic stroke among those with versus without cancer.



### Introduction 
Describe the problem addressed, its significance, and some background to motivate the problem.

Explain why your problem is interdisciplinary, what fields can contribute to its understanding, and incorporate background related to what you learned from meeting with faculty/staff.

  Estimates suggest 10% of ischemic strokes occur among those with active cancer, with a markedly increased risk of ischemic stroke demonstrated following incident cancer diagnosis.[1-3]  Moreover, these numbers may be on the rise as recent treatment advancements have dramatically increased the length of survival with active cancer.[1]  While in the last few years the topic of cancer-associated stroke has garnered growing attention in the scientific literature, the mechanisms underlying the high rates of ischemic stroke in cancer patients, as well as the associated implications of theses mechanisms for stroke prevention and treatment strategies, remain incompletely understood.[4,5]  Recognizing that the pathophysiological underpinnings of stroke in active cancer are purportedly distinct from usual stroke mechanisms, an important step in advancing understanding may be achieved through the study of the comparative person-level characteristics and risk profiles among those with versus without active stroke.

  At its core, this research question exists at the intersection of neurology, oncology, and epidemiology, with the input of all three disciplines necessary to arrive at a meaningful study design and analysis plan.  Furthermore, the substantive evaluation of sociodemographic factors, comorbidities, and cardiometabolic risk profiles from the perspective of their potential contributions to the association between cancer and ischemic stroke necessitate bringing knowledge from an even broader range of fields in medicine and the social sciences.  In my meetings with physician-researchers with expertise in a combination of these fields, I gained key insights about the importance of: 1). Hypercoagulability as a key postulated mechanism in cancer-associated stroke; 2). Cancer type as a critical consideration in any observed associations, particularly recognizing prior evidence suggesting differential ischemic stroke risks by cancer type; and, 3).  Data visualization (i.e., use of multiple Figures), given the focus of this project is to “generate a picture” of the differences in characteristics and risk factors between ischemic stroke occurrence among those with versus without cancer.  These considerations were integral in my selection of the variables for assessment, as well as the overall analysis plan described below (in the Methods). Building from the knowledge gained from my consultations with these content experts, I will utilize data collected as part of the National Health and Nutrition Examination Survey (NHANES) to assess the sociodemographic characteristics, comorbidities, and cardiometabolic risk profiles associated with ischemic strokes among those with versus without cancer.



### Methods
Describe the data used and general methodological approach. Subsequently, incorporate full R code necessary to retrieve and clean data, and perform analysis. Be sure to include a description of code so that others (including your future self) can understand what you are doing and why. 

```{r eval = TRUE, message = FALSE}

# Load all packages used for this project
library(nhanesA) 
library(plyr)
library(dplyr)
library(RNHANES)
library(weights)
library(ggsci)
library(ggthemes)
library(survey)


```


```{r eval = TRUE, message = FALSE}

# LOad data from relevant modules (DEMO=Demographic Variables & Sample Weights, MCQ=Medical Conditions, and RXQ_RX=Prescription Medications) and cycles (F=2009-2010, G=2011-2012, H=2013-2014, I=2015-2016, and J=2017-2018)

varlist <- c("DEMO", "MCQ", "RXQ_RX") 
varlist_years <- paste0(rep(varlist, each = 5), c("_F", "_G", "_H", "_I", "_J"))

list_all <- sapply(varlist_years, function(x) {data.frame(nhanes(x))}) 


#Create a data.frame for each module
for(i in 1:length(list_all)) {
  assign(names(list_all)[i], list_all[[i]])
} 

#Remove objects that are no longer needed
rm(list_all)

```



```{r eval = TRUE, message = FALSE}

#Combine modules (DEMO, MCQ, and RXQ_RX) to generate 1 larger data.frame per cycle, select and rename relevant variables, replace columns as factors for categorical variables (gender, race, history of cancer, and cancer type), filter to include only those with non-missing age>=20 years, and remove objects that are no longer needed

#2009-2010
cycle.09.10 <- left_join(DEMO_F, MCQ_F, by="SEQN") 

cycle.09.10 <- left_join(cycle.09.10, RXQ_RX_F, by="SEQN") %>%
  select(id = SEQN, cycle = SDDSRVYR, gender = RIAGENDR, age = RIDAGEYR, race =         RIDRETH1, hx.can = MCQ220, type.can1 = MCQ230A, type.can2 = MCQ230B, type.can3 =      MCQ230C, type.can4 = MCQ230D, age.bladder.can = MCQ240A, age.testi.can = MCQ240AA,    age.blood.can = MCQ240B, age.thyroid.can = MCQ240BB, age.bone.can = MCQ240C,          age.uteri.can = MCQ240CC, age.brain.can = MCQ240D, age.other.can = MCQ240DD,          age.unk.can = MCQ240DK, age.breast.can = MCQ240E, age.cervic.can = MCQ240F,           age.colon.can = MCQ240G, age.esoph.can = MCQ240H, age.gallblad.can = MCQ240I,         age.kidney.can = MCQ240J, age.larynx.can = MCQ240K, age.leukem.can = MCQ240L,         age.liver.can = MCQ240M, age.lung.can = MCQ240N, age.lymph.can = MCQ240O,             age.melano.can = MCQ240P, age.mouth.can = MCQ240Q, age.nerv.can = MCQ240R,            age.ovari.can = MCQ240S, age.pancr.can = MCQ240T, age.prost.can = MCQ240U,            age.rectal.can = MCQ240V, age.non.mela.can = MCQ240W, age.unk.skin.can = MCQ240X,     age.soft.can = MCQ240Y, age.stomach.can = MCQ240Z, drug = RXDDRGID, int.weight =      WTINT2YR) %>%
  mutate(gender = factor(gender, levels = c(1, 2), labels = c("Male", "Female"))) %>%
  mutate(race = factor(race, levels = c(3, 1, 2, 4, 5), labels = c("White",             "MexicanAmerican", "Hispanic", "Black", "Other"))) %>%
  mutate(hx.can = factor(hx.can, levels=c(1, 2, 7, 9), labels = c("Yes", "No", NA,      NA))) %>%
  mutate(type.can1 = factor(type.can1, levels=c(10, 11, 12, 13, 14, 15, 16, 17, 18,     19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39,   66, 77, 99), labels = c("Bladder", "Blood", "Bone", "Brain", "Breast", "Cervix",      "Colon", "Esophagus", "Gallbladder", "Kidney", "Larynx/Windpipe", "Leukemia",         "Liver", "Lung", "Lymphoma/Hodgkin's Disease", "Melanoma", "Mouth/Tongue/Lip",        "Nervous System", "Ovary", "Pancreas", "Prostate", "Rectum", "Skin (Non-Melanoma)",   "Skin (Kind Unknown)", "Soft Tissue", "Stomach", "Testis", "Thyroid", "Uterus",       "Other", NA, NA, NA))) %>%
  mutate(type.can2 = factor(type.can2, levels=c(10, 11, 12, 13, 14, 15, 16, 17, 18,     19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39,   66, 77, 99), labels = c("Bladder", "Blood", "Bone", "Brain", "Breast", "Cervix",      "Colon", "Esophagus", "Gallbladder", "Kidney", "Larynx/Windpipe", "Leukemia",         "Liver", "Lung", "Lymphoma/Hodgkin's Disease", "Melanoma", "Mouth/Tongue/Lip",        "Nervous System", "Ovary", "Pancreas", "Prostate", "Rectum", "Skin (Non-Melanoma)",   "Skin (Kind Unknown)", "Soft Tissue", "Stomach", "Testis", "Thyroid", "Uterus",       "Other", NA, NA, NA))) %>%
  mutate(type.can3 = factor(type.can3, levels=c(10, 11, 12, 13, 14, 15, 16, 17, 18,     19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39,   66, 77, 99), labels = c("Bladder", "Blood", "Bone", "Brain", "Breast", "Cervix",      "Colon", "Esophagus", "Gallbladder", "Kidney", "Larynx/Windpipe", "Leukemia",         "Liver", "Lung", "Lymphoma/Hodgkin's Disease", "Melanoma", "Mouth/Tongue/Lip",        "Nervous System", "Ovary", "Pancreas", "Prostate", "Rectum", "Skin (Non-Melanoma)",   "Skin (Kind Unknown)", "Soft Tissue", "Stomach", "Testis", "Thyroid", "Uterus",       "Other", NA, NA, NA))) %>%
  mutate(type.can4 = factor(type.can4, levels=c(10, 11, 12, 13, 14, 15, 16, 17, 18,     19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39,   66, 77, 99), labels = c("Bladder", "Blood", "Bone", "Brain", "Breast", "Cervix",      "Colon", "Esophagus", "Gallbladder", "Kidney", "Larynx/Windpipe", "Leukemia",         "Liver", "Lung", "Lymphoma/Hodgkin's Disease", "Melanoma", "Mouth/Tongue/Lip",        "Nervous System", "Ovary", "Pancreas", "Prostate", "Rectum", "Skin (Non-Melanoma)",   "Skin (Kind Unknown)", "Soft Tissue", "Stomach", "Testis", "Thyroid", "Uterus",       "Other", NA, NA, NA))) %>%
  filter(age >= 20)

rm(DEMO_F, MCQ_F, RXQ_RX_F)

```

```{r eval = TRUE, message = FALSE}

# Generate dummy variables for the presence versus absence of each of the assessed drugs: aspirin, dabigatran, dalteparin, enoxaparin, rivaroxaban, warfarin

#Remove duplicate rows (resulting from multiple drugs reported by a specific participant) 

```



### Results
Describe your results and include relevant tables, plots, and code/comments used to obtain them. End with a brief conclusion of your findings related to the question you set out to address. You can include references if you'd like, but this is not required.






#### References:

1. Sanossian N, MD, Djabiras C, BS, Mack WJ, MD, Ovbiagele, Bruce, MD, MS. Trends in Cancer Diagnoses among Inpatients Hospitalized with Stroke. J Stroke Cerebrovasc Dis. 2013;22(7):1146-50.

2. Navi BB, Howard G, Howard VJ, Zhao H, Judd SE, Elkind MSV, et al. The risk of arterial thromboembolic events after cancer diagnosis. Res Pract Thromb Haemost. 2019;3(4):639-51.

3. Navi BB, Howard G, Howard VJ, Zhao H, Judd SE, Elkind MSV, et al. New diagnosis of cancer and the risk of subsequent cerebrovascular events. Neurology. 2018;90(23):e2025-33.

4. Navi BB, Iadecola C. Ischemic stroke in cancer patients: A review of an underappreciated pathology. Ann Neurol. 2018;83(5):873-83.

5. Bang OY, Chung J, Lee MJ, Seo W, Kim G, Ahn M, et al. Cancer-Related Stroke: An Emerging Subtype of Ischemic Stroke with Unique Pathomechanisms. J Stroke. 2020;22(1):1-10.
